<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Glenn Williams">
<meta name="dcterms.date" content="2023-03-09">

<title>Transforming Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="exercises_files/libs/clipboard/clipboard.min.js"></script>
<script src="exercises_files/libs/quarto-html/quarto.js"></script>
<script src="exercises_files/libs/quarto-html/popper.min.js"></script>
<script src="exercises_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="exercises_files/libs/quarto-html/anchor.min.js"></script>
<link href="exercises_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="exercises_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="exercises_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="exercises_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="exercises_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Transforming Data</h1>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      Glenn Williams 
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Northumbria University
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 9, 2023</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">March 13, 2023</p>
      </div>
    </div>
      
    </div>
    
  <div>
    <div class="abstract">
      <div class="abstract-title">Abstract</div>
      Understanding the grammar of graphics
    </div>
  </div>
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#instructions" id="toc-instructions" class="nav-link active" data-scroll-target="#instructions">Instructions</a></li>
  <li><a href="#basics" id="toc-basics" class="nav-link" data-scroll-target="#basics">Basics</a>
  <ul class="collapse">
  <li><a href="#exercise-1.-loading-the-data" id="toc-exercise-1.-loading-the-data" class="nav-link" data-scroll-target="#exercise-1.-loading-the-data">Exercise 1. Loading the data</a></li>
  <li><a href="#exercise-2.-investigating-the-data" id="toc-exercise-2.-investigating-the-data" class="nav-link" data-scroll-target="#exercise-2.-investigating-the-data">Exercise 2. Investigating the data</a></li>
  <li><a href="#exercise-3.-renaming-columns" id="toc-exercise-3.-renaming-columns" class="nav-link" data-scroll-target="#exercise-3.-renaming-columns">Exercise 3. Renaming columns</a></li>
  <li><a href="#exercise-4.-separating-columns" id="toc-exercise-4.-separating-columns" class="nav-link" data-scroll-target="#exercise-4.-separating-columns">Exercise 4. Separating columns</a></li>
  <li><a href="#exercise-5.-renaming-columns" id="toc-exercise-5.-renaming-columns" class="nav-link" data-scroll-target="#exercise-5.-renaming-columns">Exercise 5. Renaming columns</a></li>
  <li><a href="#exercise-6.-filtering-columns" id="toc-exercise-6.-filtering-columns" class="nav-link" data-scroll-target="#exercise-6.-filtering-columns">Exercise 6. Filtering columns</a></li>
  <li><a href="#exercise-7.-selecting-columns" id="toc-exercise-7.-selecting-columns" class="nav-link" data-scroll-target="#exercise-7.-selecting-columns">Exercise 7. Selecting columns</a></li>
  <li><a href="#exercise-8.-mutating-columns" id="toc-exercise-8.-mutating-columns" class="nav-link" data-scroll-target="#exercise-8.-mutating-columns">Exercise 8. Mutating columns</a></li>
  </ul></li>
  <li><a href="#advanced" id="toc-advanced" class="nav-link" data-scroll-target="#advanced">Advanced</a>
  <ul class="collapse">
  <li><a href="#exercise-9.-conditional-mutation" id="toc-exercise-9.-conditional-mutation" class="nav-link" data-scroll-target="#exercise-9.-conditional-mutation">Exercise 9. Conditional mutation</a>
  <ul class="collapse">
  <li><a href="#a." id="toc-a." class="nav-link" data-scroll-target="#a.">A.</a></li>
  <li><a href="#b." id="toc-b." class="nav-link" data-scroll-target="#b.">B.</a></li>
  </ul></li>
  <li><a href="#exercise-10.-applying-functions-across-columns" id="toc-exercise-10.-applying-functions-across-columns" class="nav-link" data-scroll-target="#exercise-10.-applying-functions-across-columns">Exercise 10. Applying functions across columns</a>
  <ul class="collapse">
  <li><a href="#a.-1" id="toc-a.-1" class="nav-link" data-scroll-target="#a.-1">A.</a></li>
  <li><a href="#b.-1" id="toc-b.-1" class="nav-link" data-scroll-target="#b.-1">B.</a></li>
  </ul></li>
  <li><a href="#exercise-11.-rowwise-operations" id="toc-exercise-11.-rowwise-operations" class="nav-link" data-scroll-target="#exercise-11.-rowwise-operations">Exercise 11. Rowwise operations</a></li>
  <li><a href="#exercise-12.-more-rowwise-operations" id="toc-exercise-12.-more-rowwise-operations" class="nav-link" data-scroll-target="#exercise-12.-more-rowwise-operations">Exercise 12. More rowwise operations</a></li>
  <li><a href="#exercise-13.-subsetting-columns" id="toc-exercise-13.-subsetting-columns" class="nav-link" data-scroll-target="#exercise-13.-subsetting-columns">Exercise 13. Subsetting columns</a></li>
  <li><a href="#exercise-14.-chaining-it-all-together" id="toc-exercise-14.-chaining-it-all-together" class="nav-link" data-scroll-target="#exercise-14.-chaining-it-all-together">Exercise 14. Chaining it all together</a></li>
  <li><a href="#exercise-15.-save-the-data" id="toc-exercise-15.-save-the-data" class="nav-link" data-scroll-target="#exercise-15.-save-the-data">Exercise 15. Save the data</a></li>
  <li><a href="#exercise-16.-plotting-the-data" id="toc-exercise-16.-plotting-the-data" class="nav-link" data-scroll-target="#exercise-16.-plotting-the-data">Exercise 16. Plotting the data</a></li>
  <li><a href="#a.-2" id="toc-a.-2" class="nav-link" data-scroll-target="#a.-2">A.</a></li>
  <li><a href="#b.-2" id="toc-b.-2" class="nav-link" data-scroll-target="#b.-2">B.</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="instructions" class="level1">
<h1>Instructions</h1>
<p>Complete the following exercises. The basics will get you used to using individual data transformation functions. The advanced exercises will focus more on chaining together multiple functions to clean a real(ish) data set.</p>
</section>
<section id="basics" class="level1">
<h1>Basics</h1>
<p>First off, load the libraries you’ll need for the exercises. As always, load the <code>tidyverse</code> library. You’ll also be working with files within your working directory, so the <code>here</code> package is needed. Our data set has messy and inconsistent column headings, so <code>janitor</code> is useful. In addition, it contains a column with date times in it, so load the <code>lubridate</code> package which allows you do do relatively complex tasks with date times easily.</p>
<div class="cell">

</div>
<section id="exercise-1.-loading-the-data" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1.-loading-the-data">Exercise 1. Loading the data</h2>
<p>Load the data from the file <code>bi-loneliness.csv</code> from within the <code>data</code> folder. Assign this to the object <code>dat</code>.</p>
<div class="cell">

</div>
</section>
<section id="exercise-2.-investigating-the-data" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2.-investigating-the-data">Exercise 2. Investigating the data</h2>
<p>Use the <code>glimpse()</code> function to get an idea of what the data set looks like.</p>
<div class="cell">

</div>
</section>
<section id="exercise-3.-renaming-columns" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3.-renaming-columns">Exercise 3. Renaming columns</h2>
<p>Use the <code>clean_names()</code> function from the <code>janitor</code> package to make consistent column names. Assign the result of this to <code>dat2</code>.</p>
<div class="cell">

</div>
</section>
<section id="exercise-4.-separating-columns" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4.-separating-columns">Exercise 4. Separating columns</h2>
<p>Separate any columns that contain more than one variable and overwrite the <code>dat2</code> object with this result.</p>
<div class="cell">

</div>
</section>
<section id="exercise-5.-renaming-columns" class="level2">
<h2 class="anchored" data-anchor-id="exercise-5.-renaming-columns">Exercise 5. Renaming columns</h2>
<p>Rename the <code>pid</code> column to <code>participant_id</code> to make it more informative and overwrite the <code>dat2</code> object with this result.</p>
<div class="cell">

</div>
</section>
<section id="exercise-6.-filtering-columns" class="level2">
<h2 class="anchored" data-anchor-id="exercise-6.-filtering-columns">Exercise 6. Filtering columns</h2>
<p>Filter the data set down to only those who completed the study and overwrite the <code>dat2</code> object with this result. Be wary of inconsistent naming patterns here. If you’re unsure of what constitutes a completion check out the unique values in <code>progress</code>.</p>
<div class="cell">

</div>
<div class="cell">

</div>
</section>
<section id="exercise-7.-selecting-columns" class="level2">
<h2 class="anchored" data-anchor-id="exercise-7.-selecting-columns">Exercise 7. Selecting columns</h2>
<p>Keep only the <code>participant_id</code>, <code>start_time</code>, <code>end_time</code>, <code>gender</code>, <code>age</code> and <code>brs1</code> through to <code>brs6</code> columns and the <code>wemwbs_1</code> through to <code>wemwbs_14</code> columns and overwrite the <code>dat2</code> object with this result.</p>
<div class="cell">

</div>
</section>
<section id="exercise-8.-mutating-columns" class="level2">
<h2 class="anchored" data-anchor-id="exercise-8.-mutating-columns">Exercise 8. Mutating columns</h2>
<p>Make the <code>start_time</code> and <code>end_time</code> columns date times using the <code>ymd_hms</code> format and overwrite the <code>dat2</code> object with this result.</p>
<div class="cell">

</div>
</section>
</section>
<section id="advanced" class="level1">
<h1>Advanced</h1>
<section id="exercise-9.-conditional-mutation" class="level2">
<h2 class="anchored" data-anchor-id="exercise-9.-conditional-mutation">Exercise 9. Conditional mutation</h2>
<section id="a." class="level3">
<h3 class="anchored" data-anchor-id="a.">A.</h3>
<p>Make the <code>gender</code> labels in the data set consistent. Again, if unsure about the unique values then use the <code>unique()</code> function to find these out before you conditionally mutate the <code>gender</code> column. When done assign the result to <code>dat3</code>.</p>
<div class="cell">

</div>
<div class="cell">

</div>
</section>
<section id="b." class="level3">
<h3 class="anchored" data-anchor-id="b.">B.</h3>
<p>Can you think of a way to cut down on the number of <code>case_when()</code> statements? If so, write your code below.</p>
<div class="cell">

</div>
</section>
</section>
<section id="exercise-10.-applying-functions-across-columns" class="level2">
<h2 class="anchored" data-anchor-id="exercise-10.-applying-functions-across-columns">Exercise 10. Applying functions across columns</h2>
<section id="a.-1" class="level3">
<h3 class="anchored" data-anchor-id="a.-1">A.</h3>
<p>Look into the <code>parse_number()</code> function from the <code>readr</code> package. What does it do?</p>
</section>
<section id="b.-1" class="level3">
<h3 class="anchored" data-anchor-id="b.-1">B.</h3>
<p>You can mutate multiple columns by using the <code>across()</code> function within the <code>mutate()</code> call, e.g.&nbsp;<code>mutate(across())</code>. Use this to mutate across all columns containing the keyword “wemwbs” and apply the <code>parse_number()</code> function to them. Assign the result to <code>dat4</code>.</p>
<div class="cell">

</div>
</section>
</section>
<section id="exercise-11.-rowwise-operations" class="level2">
<h2 class="anchored" data-anchor-id="exercise-11.-rowwise-operations">Exercise 11. Rowwise operations</h2>
<p>WEMWBS columns are items from the <a href="The%20Warwick-Edinburgh%20Mental%20Wellbeing%20Scales">WEMWBS scale</a> for assessing mental wellbeing.</p>
<p>Create the column <code>wemwbs_total</code> from the sum of all columns containing the keyword <code>wemwbs</code>. Use the <code>rowwise()</code> and <code>c_across()</code> functions to achieve this. Assign the result to <code>dat4</code>.</p>
<div class="cell">

</div>
</section>
<section id="exercise-12.-more-rowwise-operations" class="level2">
<h2 class="anchored" data-anchor-id="exercise-12.-more-rowwise-operations">Exercise 12. More rowwise operations</h2>
<p>BRS columns signify items from the <a href="https://pubmed.ncbi.nlm.nih.gov/18696313/">BRS scale</a> for indexing resilience.</p>
<p>Create the column <code>brs_total</code> from the sum of all columns containing the keyword <code>brs</code> and divide them by 6. Use the <code>rowwise()</code> and <code>c_across()</code> functions to achieve this. Assign the result to <code>dat4</code>.</p>
<div class="cell">

</div>
</section>
<section id="exercise-13.-subsetting-columns" class="level2">
<h2 class="anchored" data-anchor-id="exercise-13.-subsetting-columns">Exercise 13. Subsetting columns</h2>
<p>Drop all columns containing “brs” or “wemwbs” excluding the <code>brs_total</code> and <code>wemwbs_total</code> columns from the data set. Assign this result to <code>dat5</code>.</p>
<div class="cell">

</div>
</section>
<section id="exercise-14.-chaining-it-all-together" class="level2">
<h2 class="anchored" data-anchor-id="exercise-14.-chaining-it-all-together">Exercise 14. Chaining it all together</h2>
<p>Starting from <code>dat</code>, take every operation so far and chain them all together so that you don’t save interstitial temporary data sets such as <code>dat1</code>, <code>dat2</code> etc. Assign the result to <code>dat_cleaned</code>.</p>
<div class="cell">

</div>
</section>
<section id="exercise-15.-save-the-data" class="level2">
<h2 class="anchored" data-anchor-id="exercise-15.-save-the-data">Exercise 15. Save the data</h2>
<p>Save your cleaned data in the <code>data</code> folder under the new name <code>bi_loneliness_cleaned.csv</code>.</p>
<div class="cell">

</div>
</section>
<section id="exercise-16.-plotting-the-data" class="level2">
<h2 class="anchored" data-anchor-id="exercise-16.-plotting-the-data">Exercise 16. Plotting the data</h2>
</section>
<section id="a.-2" class="level2">
<h2 class="anchored" data-anchor-id="a.-2">A.</h2>
<p>Investigate the relationship between <code>brs_total</code> and <code>wemwbs_total</code>. Apply a new theme to the data with your own tweaks to it, use informative titles and axes labels, and change the colour or fill as you see fit. Save this to the object <code>brs_wellbeing</code>.</p>
<div class="cell">

</div>
</section>
<section id="b.-2" class="level2">
<h2 class="anchored" data-anchor-id="b.-2">B.</h2>
<p>Save the <code>brs_wellbeing</code>plot to <code>03_transforming-data</code> in the <code>output</code> subfolder as <code>brs_wellbeing.png</code>.</p>
<div class="cell">

</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>